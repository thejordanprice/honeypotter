<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Honeypotter</title>
    <link rel="icon" type="image/svg+xml" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="%23000000"><path d="M61.3 27.991c-.463-2.989-2.297-12.947-6.459-15.575c-.068-.042-.127-.081-.177-.114a9.687 9.687 0 0 0-.111-2.649C53.954 6.161 49.429 2 31.272 2C13.075 2 8.542 6.161 7.944 9.651a10.029 10.029 0 0 0-.127 2.641c-.064.05-.146.111-.251.186c-2.087 1.488-5.042 7.881-5.27 11.4c-.1 1.546.269 2.719 1.095 3.486c.103.096.216.17.326.253C2.861 29.897 2 32.961 2 36.075c0 4.122.866 7.474 4.245 11.08c3.377 3.606 3.028 3.36 3.377 5.114C9.974 54.023 12.745 62 31.247 62h.002c18.502 0 21.589-7.948 21.623-9.73c.027-1.354.435-2.12 1.408-3.204c.711.55 1.461.869 2.297.869c.678 0 1.672-.223 2.566-1.282c3.336-3.958 3.301-13.269 2.157-20.662M31.242 56.044c-13.896 0-21.681-5.621-21.681-6.133c0-.511 7.785 4.279 21.681 4.279c13.892 0 21.677-4.79 21.677-4.279c0 .512-7.785 6.133-21.677 6.133m26.421-8.64c-.347.412-.709.595-1.086.595c-3.079 0-7.105-12.257-11.436-12.257c-6.261 0-4.728-12.934-11.883-12.934c-1.926 0-10.222 6.403-12.778 6.403c-2.557 0-2.94-6.403-6.006-6.403c-3.717 0-6.51 3.61-8.609 3.61c-.412 0-.798-.139-1.159-.473c-1.891-1.755 2.148-10.584 3.983-11.891c1.835-1.311.667-1.182 1.162-4.075c.496-2.895 5.654-6.043 21.421-6.043c15.762 0 20.898 3.271 21.374 6.043c.495 2.894-.745 2.871 1.162 4.075c5.285 3.336 8.863 27.412 3.855 33.35" />
                        <path d="M31.249 16.766c-11.895 0-21.001-3.797-21.001-3.285c0 .513 9.106 4.892 21.001 4.892c11.893 0 21.001-4.379 21.001-4.892c0-.512-9.108 3.285-21.001 3.285" />
                        <path d="M16.614 9.664c2.648.987 8.198 1.667 14.635 1.667c6.438 0 11.987-.68 14.635-1.667c1.055-.395 1.662-.833 1.662-1.3c0-1.639-7.296-2.968-16.297-2.968c-9 0-16.296 1.329-16.296 2.968c0 .467.607.906 1.661 1.3" />
                    </svg>'>
    <link href="{{ versioned_static('dist/tailwind/tailwind.min.css') }}" rel="stylesheet">
    <link rel="stylesheet" href="{{ versioned_static('dist/leaflet/leaflet.css') }}" />
    <link rel="stylesheet" href="{{ versioned_static('dist/mapbox/leaflet.fullscreen.css') }}" />
    <link rel="stylesheet" href="{{ versioned_static('css/styles.css') }}">
    <script src="{{ versioned_static('dist/chart.js/chart.js') }}"></script>
    <script src="{{ versioned_static('dist/leaflet/leaflet.js') }}"></script>
    <script src="{{ versioned_static('dist/leaflet/leaflet-heat.js') }}"></script>
    <script src="{{ versioned_static('dist/mapbox/Leaflet.fullscreen.min.js') }}"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white dark:bg-gray-800 shadow-lg mb-8">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center h-full">
                    <svg class="w-6 h-6 mr-2 flex-shrink-0" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" stroke="none" fill="currentColor">
                        <path d="M61.3 27.991c-.463-2.989-2.297-12.947-6.459-15.575c-.068-.042-.127-.081-.177-.114a9.687 9.687 0 0 0-.111-2.649C53.954 6.161 49.429 2 31.272 2C13.075 2 8.542 6.161 7.944 9.651a10.029 10.029 0 0 0-.127 2.641c-.064.05-.146.111-.251.186c-2.087 1.488-5.042 7.881-5.27 11.4c-.1 1.546.269 2.719 1.095 3.486c.103.096.216.17.326.253C2.861 29.897 2 32.961 2 36.075c0 4.122.866 7.474 4.245 11.08c3.377 3.606 3.028 3.36 3.377 5.114C9.974 54.023 12.745 62 31.247 62h.002c18.502 0 21.589-7.948 21.623-9.73c.027-1.354.435-2.12 1.408-3.204c.711.55 1.461.869 2.297.869c.678 0 1.672-.223 2.566-1.282c3.336-3.958 3.301-13.269 2.157-20.662M31.242 56.044c-13.896 0-21.681-5.621-21.681-6.133c0-.511 7.785 4.279 21.681 4.279c13.892 0 21.677-4.79 21.677-4.279c0 .512-7.785 6.133-21.677 6.133m26.421-8.64c-.347.412-.709.595-1.086.595c-3.079 0-7.105-12.257-11.436-12.257c-6.261 0-4.728-12.934-11.883-12.934c-1.926 0-10.222 6.403-12.778 6.403c-2.557 0-2.94-6.403-6.006-6.403c-3.717 0-6.51 3.61-8.609 3.61c-.412 0-.798-.139-1.159-.473c-1.891-1.755 2.148-10.584 3.983-11.891c1.835-1.311.667-1.182 1.162-4.075c.496-2.895 5.654-6.043 21.421-6.043c15.762 0 20.898 3.271 21.374 6.043c.495 2.894-.745 2.871 1.162 4.075c5.285 3.336 8.863 27.412 3.855 33.35" />
                        <path d="M31.249 16.766c-11.895 0-21.001-3.797-21.001-3.285c0 .513 9.106 4.892 21.001 4.892c11.893 0 21.001-4.379 21.001-4.892c0-.512-9.108 3.285-21.001 3.285" />
                        <path d="M16.614 9.664c2.648.987 8.198 1.667 14.635 1.667c6.438 0 11.987-.68 14.635-1.667c1.055-.395 1.662-.833 1.662-1.3c0-1.639-7.296-2.968-16.297-2.968c-9 0-16.296 1.329-16.296 2.968c0 .467.607.906 1.661 1.3" />
                    </svg>
                    <h1 class="text-xl font-semibold text-gray-800">Honeypotter</h1>
                </div>
                <div class="flex items-center h-full gap-4">
                    <div class="p-2 w-[88px] h-[40px] rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors flex items-center justify-center gap-2" title="Total Attacks">
                        <svg class="w-5 h-5 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3V7M12 17V21M3 12H7M17 12H21M12 12H12.01M19 12C19 15.866 15.866 19 12 19C8.13401 19 5 15.866 5 12C5 8.13401 8.13401 5 12 5C15.866 5 19 8.13401 19 12Z"/>
                        </svg>
                        <span id="totalAttempts" class="font-semibold metric-update">0</span>
                    </div>
                    <div class="p-2 w-[88px] h-[40px] rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors flex items-center justify-center gap-2" title="Unique Attackers">
                        <svg class="w-5 h-5 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <span id="uniqueAttackers" class="font-semibold metric-update">0</span>
                    </div>
                    <!-- Hamburger Menu Button -->
                    <div class="relative">
                        <button id="hamburgerBtn" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                            </svg>
                        </button>
                        <!-- Mobile Menu -->
                        <div id="mobileMenu" class="hidden absolute top-full right-0 w-64 bg-white dark:bg-gray-800 shadow-lg rounded-lg z-50">
                            <div class="p-4 space-y-4">
                                <button id="exportDataButton" class="w-full p-2 flex items-center gap-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                    </svg>
                                    <span>Export Data</span>
                                </button>
                                <button id="systemStatusButton" class="w-full p-2 flex items-center gap-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    <span>System Status</span>
                                </button>
                                <button id="faqButton" class="w-full p-2 flex items-center gap-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>FAQ</span>
                                </button>
                                <button id="darkModeToggleMenu" class="w-full p-2 flex items-center gap-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                                    <svg id="darkIconMenu" class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                                    </svg>
                                    <svg id="lightIconMenu" class="w-5 h-5 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                                    </svg>
                                    <span id="themeText">Light Mode</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 pb-8">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8 overflow-hidden">
            <h2 class="text-xl font-semibold mb-4">Attack Map</h2>
            <div id="map" class="w-full h-96 md:h-[500px] border border-gray-200 dark:border-gray-700"></div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 overflow-hidden">
                <h2 class="text-xl font-semibold mb-4">Protocol Activity</h2>
                <div class="chart-container w-full">
                    <canvas id="attemptsChart"></canvas>
                </div>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 overflow-hidden">
                <h2 class="text-xl font-semibold mb-4">Top Usernames</h2>
                <div class="chart-container w-full">
                    <canvas id="usernamesChart"></canvas>
                </div>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 overflow-hidden">
                <h2 class="text-xl font-semibold mb-4">Source IPs</h2>
                <div class="chart-container w-full">
                    <canvas id="ipsChart"></canvas>
                </div>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 overflow-hidden">
                <h2 class="text-xl font-semibold mb-4">Top Countries</h2>
                <div class="chart-container w-full">
                    <canvas id="countriesChart"></canvas>
                </div>
            </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
            <div class="p-4 border-b border-gray-200">
                <h2 class="text-xl font-semibold">Recent Login Attempts</h2>
            </div>
            <div class="p-4">
                <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                    <div class="w-full sm:w-2/3">
                        <input type="text" id="searchInput" placeholder="Search..." 
                               class="w-full px-4 py-2 border rounded-lg">
                    </div>
                    <div class="w-full sm:w-1/3 flex flex-col sm:flex-row gap-4">
                        <div class="w-full sm:w-1/2">
                            <select id="filterSelect" class="w-full px-4 py-2 border rounded-lg">
                                <option value="all">All Time</option>
                                <option value="lastHour">Last Hour</option>
                                <option value="today">Today</option>
                                <option value="thisWeek">This Week</option>
                            </select>
                        </div>
                        <div class="w-full sm:w-1/2">
                            <select id="protocolSelect" class="w-full px-4 py-2 border rounded-lg">
                                <option value="all">All Protocols</option>
                                <option value="ssh">SSH Only</option>
                                <option value="telnet">Telnet Only</option>
                                <option value="ftp">FTP Only</option>
                                <option value="smtp">SMTP Only</option>
                                <option value="rdp">RDP Only</option>
                                <option value="sip">SIP Only</option>
                                <option value="mysql">MySQL Only</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div id="attempts" class="space-y-4"></div>
                <div class="mt-4 flex flex-col sm:flex-row justify-between items-center gap-4">
                    <div class="text-sm text-gray-600 order-2 sm:order-1">
                        Showing <span id="startRange">0</span>-<span id="endRange">0</span> of <span id="totalItems">0</span> attempts
                    </div>
                    <div class="flex space-x-2 order-1 sm:order-2">
                        <button id="prevPage" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed">
                            Previous
                        </button>
                        <button id="nextPage" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-white dark:bg-gray-800 shadow-lg mt-8 py-4">
        <div class="container mx-auto px-4 text-center text-gray-600">
            made with ❤️ by <a href="https://github.com/thejordanprice" class="text-blue-600 hover:text-blue-800 transition-colors" target="_blank">thejordanprice</a>
        </div>
    </footer>

    <!-- Connection status indicator -->
    <div id="connectionStatusIndicator" class="connected">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
    </div>

    <!-- Single Attack View Footer -->
    <div id="singleAttackViewFooter">
        <div class="view-info">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <div class="attack-details">
                <span class="title">Single Attack View</span>
                <span class="subtitle" id="attackDetails">Viewing details for a specific attack</span>
            </div>
        </div>
        <button id="resetViewButton">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.636 18.364a9 9 0 010-12.728m12.728 0a9 9 0 010 12.728m-9.9-2.829a5 5 0 010-7.07m7.072 0a5 5 0 010 7.07M13 12a1 1 0 11-2 0 1 1 0 012 0z" />
            </svg>
            Live View
        </button>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="flex flex-col items-center bg-white dark:bg-gray-800 rounded-xl p-6 shadow-2xl max-w-md mx-4 w-full transform transition-all">
            <div class="w-full mb-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="text-gray-600 dark:text-gray-300 text-sm font-medium" id="loadingText">Loading data...</div>
                    <div class="text-gray-600 dark:text-gray-300 text-sm font-medium" id="loadingPercentage">0%</div>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mb-1 overflow-hidden">
                    <div id="loadingBar" class="bg-blue-500 dark:bg-blue-400 h-1.5 rounded-full transition-all duration-300 ease-out" style="width: 0%"></div>
                </div>
            </div>
            <div class="w-full flex justify-center items-center">
                <div class="text-xs text-gray-500 dark:text-gray-400 text-center" id="loadingDetail">Connecting to server...</div>
            </div>
            <div id="loadingActions" class="w-full mt-3 flex justify-center">
                <!-- Refresh button will be added here when needed -->
            </div>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div id="faqModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 w-11/12 max-w-2xl rounded-lg shadow-xl max-h-[90vh] flex flex-col overflow-hidden" onclick="event.stopPropagation()">
            <div class="flex-none bg-white dark:bg-gray-800 rounded-t-lg w-full">
                <div class="flex justify-between items-center p-6">
                    <h2 class="text-xl font-bold text-gray-900 dark:text-white">Frequently Asked Questions</h2>
                    <button id="closeFaqModal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="modal-content flex-grow overflow-y-auto p-6">
                <div class="space-y-6">
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-2">What is Honeypotter?</h3>
                        <p class="text-gray-600 dark:text-gray-300">Honeypotter is a honeypot monitoring system that tracks and visualizes attempted unauthorized access to various network services. It helps security researchers and system administrators understand attack patterns and origins while providing valuable insight into emerging threats and attacker techniques.</p>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-2">How does it work?</h3>
                        <p class="text-gray-600 dark:text-gray-300">The system sets up decoy services that log connection attempts, usernames, passwords, and IP addresses. These services appear legitimate to attackers but don't provide actual access to sensitive systems. All interaction data is then analyzed and displayed in real-time through various charts and visualizations.</p>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-2">What honeypot services are supported?</h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-gray-600 dark:text-gray-300 mt-2">
                            <div class="bg-white dark:bg-gray-700 rounded p-2 text-center">
                                <p class="font-medium">SSH</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded p-2 text-center">
                                <p class="font-medium">Telnet</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded p-2 text-center">
                                <p class="font-medium">FTP</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded p-2 text-center">
                                <p class="font-medium">SMTP</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded p-2 text-center">
                                <p class="font-medium">RDP</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded p-2 text-center">
                                <p class="font-medium">SIP</p>
                            </div>
                            <div class="bg-white dark:bg-gray-700 rounded p-2 text-center">
                                <p class="font-medium">MySQL</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-2">What information is collected?</h3>
                        <p class="text-gray-600 dark:text-gray-300">For each connection attempt, we log:</p>
                        <ul class="list-disc ml-6 mt-2 text-gray-600 dark:text-gray-300">
                            <li>IP address and geolocation data (country, city, coordinates)</li>
                            <li>Attempted username and password combinations</li>
                            <li>Protocol used (SSH, Telnet, FTP, etc.)</li>
                            <li>Timestamp of the attempt</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-2">Is this legal?</h3>
                        <p class="text-gray-600 dark:text-gray-300">Yes. Honeypots are legal security tools used for research and defense. We don't engage with attackers or collect any data beyond what they voluntarily provide in their connection attempts. No actual vulnerable services are exposed, and no systems are compromised.</p>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-2">How can I use the data collected?</h3>
                        <p class="text-gray-600 dark:text-gray-300">The data can be used for:</p>
                        <ul class="list-disc ml-6 mt-2 text-gray-600 dark:text-gray-300">
                            <li>Early threat detection and intelligence</li>
                            <li>Understanding attacker techniques and tools</li>
                            <li>Creating IP blacklists and security rules</li>
                            <li>Security research and education</li>
                            <li>Testing and improving security measures</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-2">Is Honeypotter appropriate for production environments?</h3>
                        <p class="text-gray-600 dark:text-gray-300">While Honeypotter can be deployed in production environments, it's recommended to run it on dedicated systems separated from your critical infrastructure. This ensures that if a honeypot is compromised, your real systems remain secure. Always follow security best practices when deploying honeypots.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Status Modal -->
    <div id="systemStatusModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 backdrop-filter backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-900 w-11/12 max-w-4xl rounded-lg shadow-xl max-h-[90vh] flex flex-col overflow-hidden transform transition-transform duration-300" onclick="event.stopPropagation()">
            <div class="flex-none bg-white dark:bg-gray-900 rounded-t-lg w-full">
                <div class="flex justify-between items-center p-6">
                    <h2 class="text-xl font-semibold text-gray-900 dark:text-white">System Status</h2>
                    <button id="closeSystemStatusModal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="modal-content flex-grow overflow-y-auto dark:bg-gray-900">
                <div class="p-6 space-y-8">
                    <!-- System Metrics -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Resources</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <!-- CPU Usage -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">CPU</h4>
                                    <span id="cpuPercent" class="text-2xl font-bold text-gray-900 dark:text-white tracking-tight metric-update">-%</span>
                                </div>
                                <div class="w-full bg-gray-100 dark:bg-gray-700 rounded-full h-1.5">
                                    <div id="cpuBar" class="bg-blue-500 dark:bg-blue-400 h-1.5 rounded-full transition-all duration-300 ease-in-out" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Memory Usage -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Memory</h4>
                                    <span id="memoryPercent" class="text-2xl font-bold text-gray-900 dark:text-white tracking-tight metric-update">-%</span>
                                </div>
                                <div class="w-full bg-gray-100 dark:bg-gray-700 rounded-full h-1.5">
                                    <div id="memoryBar" class="bg-green-500 dark:bg-green-400 h-1.5 rounded-full transition-all duration-300 ease-in-out" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Disk Usage -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Disk</h4>
                                    <span id="diskPercent" class="text-2xl font-bold text-gray-900 dark:text-white tracking-tight metric-update">-%</span>
                                </div>
                                <div class="w-full bg-gray-100 dark:bg-gray-700 rounded-full h-1.5">
                                    <div id="diskBar" class="bg-yellow-500 dark:bg-yellow-400 h-1.5 rounded-full transition-all duration-300 ease-in-out" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Network Traffic -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300 mb-3">Network Traffic</h4>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs text-gray-500 dark:text-gray-400">Sent</span>
                                        <span id="networkSent" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs text-gray-500 dark:text-gray-400">Received</span>
                                        <span id="networkReceived" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                                    </div>
                                </div>
                            </div>

                            <!-- External IP -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">External IP</h4>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span id="externalIP" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                                    <button id="refreshIP" class="p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" title="Refresh IP">
                                        <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- System Uptime -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Uptime</h4>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span id="systemUptime" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                                </div>
                            </div>

                            <!-- Network Connections -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">Connections</h4>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span id="networkConnections" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                                </div>
                            </div>

                            <!-- System Load -->
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-5 shadow-sm">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="text-sm font-medium text-gray-600 dark:text-gray-300">System Load</h4>
                                </div>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs text-gray-500 dark:text-gray-400">1min</span>
                                        <span id="load1min" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-xs text-gray-500 dark:text-gray-400">5min</span>
                                        <span id="load5min" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Service Status -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Services</h3>
                        <div id="serviceStatus" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4">
                            <!-- Service status items will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Data Modal -->
    <div id="exportDataModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 backdrop-filter backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-900 w-11/12 max-w-md rounded-lg shadow-xl max-h-[90vh] flex flex-col overflow-hidden transform transition-transform duration-300" onclick="event.stopPropagation()">
            <div class="flex-none bg-white dark:bg-gray-900 rounded-t-lg w-full">
                <div class="flex justify-between items-center p-6">
                    <h2 class="text-xl font-semibold text-gray-900 dark:text-white">Export Data</h2>
                    <button id="closeExportDataModal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="modal-content flex-grow overflow-y-auto dark:bg-gray-900">
                <div class="p-6 space-y-6">
                    
                    <!-- Export Buttons -->
                    <div class="space-y-4">
                        <button id="exportIPs" class="w-full p-4 flex items-center gap-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                            <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V7a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <div class="flex-1">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">Plaintext</h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Simple list of all IP addresses</p>
                            </div>
                        </button>
                        
                        <button id="exportJSON" class="w-full p-4 flex items-center gap-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                            <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2zM9 9h6v6H9V9z" />
                            </svg>
                            <div class="flex-1">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">JSON</h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Complete data in JSON format</p>
                            </div>
                        </button>
                        
                        <button id="exportCSV" class="w-full p-4 flex items-center gap-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                            <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            <div class="flex-1">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">CSV</h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Spreadsheet-friendly CSV format</p>
                            </div>
                        </button>
                        
                        <!-- Firewall Rules Section Heading -->
                        <div class="pt-4 border-t border-gray-200 dark:border-gray-700 mt-4">
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Firewall Rules</h3>
                        </div>
                        
                        <!-- Mikrotik Firewall Export -->
                        <button id="exportMikrotik" class="w-full p-4 flex items-center gap-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                            <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                            <div class="flex-1">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">MikroTik</h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Router firewall block commands</p>
                            </div>
                        </button>
                        
                        <!-- IPTables Firewall Export -->
                        <button id="exportIPTables" class="w-full p-4 flex items-center gap-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                            <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />
                            </svg>
                            <div class="flex-1">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">IPTables</h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Linux iptables firewall rules</p>
                            </div>
                        </button>
                        
                        <!-- Cisco ASA Firewall Export -->
                        <button id="exportCisco" class="w-full p-4 flex items-center gap-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                            <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" />
                            </svg>
                            <div class="flex-1">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">Cisco ASA</h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Cisco ASA firewall configuration</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ versioned_static('js/utility.js') }}"></script>
    <script src="{{ versioned_static('js/visualizations.js') }}"></script>
    <script src="{{ versioned_static('js/charts.js') }}"></script>
    <script src="{{ versioned_static('js/system-monitor.js') }}"></script>
    <script src="{{ versioned_static('js/map-controls-fix.js') }}"></script>
    <script src="{{ versioned_static('js/faq-modal.js') }}"></script>
    <script src="{{ versioned_static('js/main.js') }}"></script>
</body>
</html> 